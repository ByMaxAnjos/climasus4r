% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/sus_data_read.R
\name{sus_data_read}
\alias{sus_data_read}
\title{Read Processed Health Data with Automatic Format Detection}
\usage{
sus_data_read(
  file_path,
  format = NULL,
  read_metadata = TRUE,
  validate = TRUE,
  lang = "pt",
  verbose = TRUE
)
}
\arguments{
\item{file_path}{Character string specifying the input file path.}

\item{format}{Character string specifying the input format. Options:
\code{"rds"}, \code{"arrow"}, \code{"geoparquet"}, \code{"shapefile"}, \code{"gpkg"}, \code{"geojson"}, \code{"csv"}.
If \code{NULL} (default), automatically detects format from file extension.}

\item{read_metadata}{Logical. If \code{TRUE} (default), attempts to load companion
metadata file (if it exists) and attaches it as an attribute to the returned object.}

\item{validate}{Logical. If \code{TRUE} (default), validates data integrity after loading.
For spatial data, checks geometry validity and CRS.}

\item{lang}{Character string specifying the language for messages. Options:
\code{"en"} (English), \code{"pt"} (Portuguese, default), \code{"es"} (Spanish).}

\item{verbose}{Logical. If \code{TRUE} (default), prints loading progress and summary.}
}
\value{
A data frame or sf object (for spatial data) containing the loaded data.
If metadata was found and \code{read_metadata = TRUE}, metadata is attached as
an attribute accessible via \code{attr(df, "metadata")}.
}
\description{
Intelligently reads health data files exported by \code{sus_data_export()} or
created externally. Automatically detects file format, reads spatial data,
loads metadata, and validates data integrity.
}
\details{
\strong{Automatic Format Detection}:
The function automatically detects the file format based on the extension:
\itemize{
\item \code{.rds} → RDS format
\item \code{.parquet}, \code{.arrow} → Arrow/Parquet or GeoParquet (auto-detected)
\item \code{.geoparquet} → GeoParquet
\item \code{.shp} → Shapefile
\item \code{.gpkg} → GeoPackage
\item \code{.geojson} → GeoJSON
\item \code{.csv} → CSV
}

\strong{GeoParquet Detection}:
For \code{.parquet} files, the function automatically determines if it's a GeoParquet
(spatial) or regular Parquet file by checking for spatial metadata.

\strong{Metadata Loading}:
If a companion metadata file exists (e.g., \code{data_metadata.txt} for \code{data.parquet}),
it is automatically loaded and attached to the returned object.

\strong{Data Validation}:
When \code{validate = TRUE}, the function checks:
\itemize{
\item Non-zero rows and columns
\item For spatial data: valid geometries, defined CRS, valid bounding box
}
}
\examples{
\dontrun{
library(climasus4r)

# Read with automatic format detection
df <- sus_data_read("output/data.parquet")

# Read spatial data (GeoParquet)
sf_data <- sus_data_read("output/spatial_data.geoparquet")

# Read shapefile
sf_data <- sus_data_read("output/spatial_data.shp")

# Read without metadata
df <- sus_data_read("output/data.rds", read_metadata = FALSE)

# Access metadata
df <- sus_data_read("output/data.parquet")
metadata <- attr(df, "metadata")
print(metadata$source_system)
print(metadata$years)

# Silent reading
df <- sus_data_read("output/data.csv", verbose = FALSE)
}

}
