% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/sus_data_import.R
\name{sus_data_import}
\alias{sus_data_import}
\title{Import and preprocess data from DATASUS with intelligent caching}
\usage{
sus_data_import(
  uf = NULL,
  region = NULL,
  year,
  month = NULL,
  system,
  use_cache = TRUE,
  cache_dir = "~/.climasus4r_cache/data",
  force_redownload = FALSE,
  parallel = FALSE,
  workers = 4,
  lang = "pt",
  verbose = TRUE
)
}
\arguments{
\item{uf}{A string or vector of strings with state abbreviations (\strong{igonered if 'region' is provided})
(e.g., "AM", c("SP", "RJ")). Valid UF codes: AC, AL, AP, AM, BA, CE, DF, ES,
GO, MA, MT, MS, MG, PA, PB, PR, PE, PI, RJ, RN, RS, RO, RR, SC, SP, SE, TO.}

\item{region}{A string indicating a predefined group of states (supports multilingual names PT, EN, ES). Available regions:

\strong{IBGE Macro-regions:}
\itemize{
\item \code{"norte"}: c("AC", "AP", "AM", "PA", "RO", "RR", "TO")
\item \code{"nordeste"}: c("AL", "BA", "CE", "MA", "PB", "PE", "PI", "RN", "SE")
\item \code{"centro_oeste"}: c("DF", "GO", "MT", "MS")
\item \code{"sudeste"}: c("ES", "MG", "RJ", "SP")
\item \code{"sul"}: c("PR", "RS", "SC")
}

\strong{Biomes (Ecological Borders):}
\itemize{
\item \code{"amazonia_legal"}: c("AC", "AP", "AM", "PA", "RO", "RR", "MT", "MA", "TO")
\item \code{"mata_atlantica"}: c("AL", "BA", "CE", "ES", "GO", "MA", "MG", "MS", "PB", "PE", "PI", "PR", "RJ", "RN", "RS", "SC", "SE", "SP")
\item \code{"caatinga"}: c("AL", "BA", "CE", "MA", "PB", "PE", "PI", "RN", "SE", "MG")
\item \code{"cerrado"}: c("BA", "DF", "GO", "MA", "MG", "MS", "MT", "PA", "PI", "PR", "RO", "SP", "TO")
\item \code{"pantanal"}: c("MT", "MS")
\item \code{"pampa"}: c("RS")
}

\strong{Hydrography & Climate:}
\itemize{
\item \code{"bacia_amazonia"}: c("AC", "AM", "AP", "MT", "PA", "RO", "RR")
\item \code{"bacia_sao_francisco"}: c("AL", "BA", "DF", "GO", "MG", "PE", "SE")
\item \code{"bacia_parana"}: c("GO", "MG", "MS", "PR", "SP")
\item \code{"bacia_tocantins"}: c("GO", "MA", "PA", "TO")
\item \code{"semi_arido"}: c("AL", "BA", "CE", "MA", "PB", "PE", "PI", "RN", "SE", "MG")
}

\strong{Health, Agriculture & Geopolitics:}
\itemize{
\item \code{"matopiba"}: c("MA", "TO", "PI", "BA")
\item \code{"arco_desmatamento"}: c("RO", "AC", "AM", "PA", "MT", "MA")
\item \code{"dengue_hyperendemic"}: c("GO", "MS", "MT", "PR", "RJ", "SP")
\item \code{"sudene"}: c("AL", "BA", "CE", "MA", "PB", "PE", "PI", "RN", "SE", "MG", "ES")
\item \code{"fronteira_brasil"}: c("AC", "AM", "AP", "MT", "MS", "PA", "PR", "RO", "RR", "RS", "SC")
}}

\item{year}{An integer or vector of integers with the desired years (4 digits).}

\item{month}{An integer or vector of integers with the desired months (1-12).
This argument is only used with monthly-based health information systems:
SIH, CNES, and SIA. For annual systems (SIM, SINAN, SINASC), this parameter
is ignored.}

\item{system}{A string indicating the information system. Available systems:

\strong{Mortality Systems (SIM - Mortality Information System):}
\itemize{
\item \code{"SIM-DO"}: Death certificates (Declaracoes de Obito) - Complete dataset
\item \code{"SIM-DOFET"}: Fetal deaths (Obitos Fetais)
\item \code{"SIM-DOEXT"}: External causes deaths (Obitos por Causas Externas)
\item \code{"SIM-DOINF"}: Infant deaths (Obitos Infantis)
\item \code{"SIM-DOMAT"}: Maternal deaths (Obitos Maternos)
}

\strong{Hospitalization Systems (SIH - Hospital Information System):}
\itemize{
\item \code{"SIH-RD"}: Hospital Admission Authorizations (AIH - Autorizacoes de Internacao Hospitalar)
\item \code{"SIH-RJ"}: Hospital Admission Authorizations - Rio de Janeiro specific
\item \code{"SIH-SP"}: Hospital Admission Authorizations - Sao Paulo specific
\item \code{"SIH-ER"}: Emergency Room Records (Prontuarios de Emergencia)
}

\strong{Notifiable Diseases (SINAN - Notifiable Diseases Information System):}
\itemize{
\item \code{"SINAN-DENGUE"}: Dengue fever cases
\item \code{"SINAN-CHIKUNGUNYA"}: Chikungunya cases
\item \code{"SINAN-ZIKA"}: Zika virus cases
\item \code{"SINAN-MALARIA"}: Malaria cases
\item \code{"SINAN-CHAGAS"}: Chagas disease cases
\item \code{"SINAN-LEISHMANIOSE-VISCERAL"}: Visceral leishmaniasis cases
\item \code{"SINAN-LEISHMANIOSE-TEGUMENTAR"}: Cutaneous leishmaniasis cases
\item \code{"SINAN-LEPTOSPIROSE"}: Leptospirosis cases
}

\strong{Outpatient Systems (SIA - Outpatient Information System):}
\itemize{
\item \code{"SIA-AB"}: Primary Care (Atencao Basica)
\item \code{"SIA-ABO"}: Dental Procedures (Procedimentos Odontologicos)
\item \code{"SIA-ACF"}: Pharmaceutical Assistance (Assistencia Farmaceutica)
\item \code{"SIA-AD"}: High Complexity (Alta Complexidade/Diferenciada)
\item \code{"SIA-AN"}: Home Care (Atencao Domiciliar)
\item \code{"SIA-AM"}: Medical Specialties (Ambulatorio de Especialidades)
\item \code{"SIA-AQ"}: Strategic Actions (Acoes Estrategicas)
\item \code{"SIA-AR"}: Regulation (Regulacao)
\item \code{"SIA-ATD"}: Urgency/Emergency (Urgencia/Emergencia)
\item \code{"SIA-PA"}: Hospital Outpatient (Procedimentos Ambulatoriais em Hospital)
\item \code{"SIA-PS"}: Psychosocial Care (Atencao Psicossocial)
\item \code{"SIA-SAD"}: Specialized Care (Atencao Especializada)
}

\strong{Health Establishments (CNES - National Health Establishment Registry):}
\itemize{
\item \code{"CNES-LT"}: Beds (Leitos)
\item \code{"CNES-ST"}: Health Professionals (Profissionais de Saude)
\item \code{"CNES-DC"}: Equipment (Equipamentos) - Detailed
\item \code{"CNES-EQ"}: Equipment (Equipamentos) - Summary
\item \code{"CNES-SR"}: Specialized Services (Servicos Especializados)
\item \code{"CNES-HB"}: Hospital Beds (Leitos Hospitalares)
\item \code{"CNES-PF"}: Health Professionals Detailed (Pessoal Fisico)
\item \code{"CNES-EP"}: Teaching Participants (Participantes do Ensino)
\item \code{"CNES-RC"}: Hospital Class (Classificacao Hospitalar)
\item \code{"CNES-IN"}: Hospital Indicators (Indicadores Hospitalares)
\item \code{"CNES-EE"}: Educational Entities (Entidades de Ensino)
\item \code{"CNES-EF"}: Teaching Facilities (Instalacoes de Ensino)
\item \code{"CNES-GM"}: Management/Support (Gestao e Apoio)
}

\strong{Live Births (SINASC - Live Birth Information System):}
\itemize{
\item \code{"SINASC"}: Live Birth Declarations (Declaracoes de Nascidos Vivos)
}}

\item{use_cache}{Logical. If TRUE (default), will use cached data to avoid
re-downloads. Cache is based on UF, year, month, and system parameters.}

\item{cache_dir}{Character. Directory to store cached files.
Default is "~/.climasus4r_cache/data".}

\item{force_redownload}{Logical. If TRUE, ignores cache and re-downloads
everything. Useful when you suspect cached data is corrupted or outdated.}

\item{parallel}{Logical. If TRUE (default), will use parallel processing
for multiple UF/year combinations. Significantly speeds up bulk downloads.}

\item{workers}{Integer. Number of parallel workers to use. Default is 4.
Set to 1 to disable parallel processing.}

\item{lang}{Character string specifying the language for variable labels and
messages. Options: \code{"en"} (English), \code{"pt"} (Portuguese, default), \code{"es"} (Spanish).}

\item{verbose}{Logical. If TRUE (default), prints detailed progress
information including cache status, download progress, and time estimates.}
}
\value{
A \code{tibble} (or \code{data.frame}) with the requested data, combining
multiple UFs/years when requested. The output includes:
\itemize{
\item All original variables from the DATASUS system
\item Additional metadata columns: \code{source_system}, \code{download_timestamp}
\item Standardized date formats (Date objects instead of strings)
\item UTF-8 encoded character variables
}

\strong{Note}: Large datasets (especially SIA and SIH) may require significant
memory (1GB+ for national annual data).
}
\description{
This function acts as a wrapper for \code{microdatasus::fetch_datasus},
simplifying the download and reading of data from Brazilian public health
information systems (SIM, SINAN, SIH, SIA, CNES, SINASC).
It includes parallel processing, caching, and user-friendly CLI feedback.
}
\details{
\subsection{Data Sources}{

All data is sourced from the Brazilian Ministry of Health's DATASUS portal
(http://datasus.saude.gov.br).
}

\subsection{Caching System}{

The cache uses SHA-256 hashing of parameters to create unique cache keys.
Cached files are stored as compressed RDS files and include metadata about
the download date and parameter combination. Cache is automatically invalidated
after 30 days for dynamic systems (CNES, SIA, SIH) and 365 days for static
systems (SIM, SINAN, SINASC).
}

\subsection{Parallel Processing}{

When downloading data for multiple states or years, parallel processing
can reduce download time by up to 70\%. The function uses \code{future.apply}
internally. For large downloads (>100 files), consider increasing \code{workers}
up to 8 (if your system has sufficient cores and memory).
}
}
\examples{
\dontrun{
# Basic example: Mortality data for Rio de Janeiro in 2022
df_sim <- sus_data_import(
  uf = "RJ", 
  year = 2022, 
  system = "SIM-DO",
  use_cache = TRUE
)

# Dengue cases for two states with parallel processing
df_dengue <- sus_data_import(
  uf = c("SP", "MG"), 
  year = 2023, 
  system = "SINAN-DENGUE",
  parallel = TRUE,
  workers = 3
)

# Hospitalizations with monthly specification
df_hospital <- sus_data_import(
  uf = "SP",
  year = 2024,
  month = 1:6,  # January to June
  system = "SIH-RD",
  verbose = TRUE
)

# Force re-download ignoring cache
df_births <- sus_data_import(
  uf = "BA",
  year = 2020:2022,
  system = "SINASC",
  use_cache = TRUE,
  force_redownload = TRUE  # Refresh cached data
)
}

}
\references{
Brazilian Ministry of Health. DATASUS. \url{http://datasus.saude.gov.br}

SALDANHA, Raphael de Freitas; BASTOS, Ronaldo Rocha; BARCELLOS, Christovam. Microdatasus: pacote para download e pre-processamento de microdados do Departamento de Informatica do SUS (DATASUS). Cad. Saude Publica, Rio de Janeiro , v. 35, n. 9, e00032419, 2019. Available from https://doi.org/10.1590/0102-311x00032419.
}
\seealso{
\itemize{
\item Official DATASUS documentation: \url{http://datasus.saude.gov.br}
\item Microdatasus package: \url{https://github.com/rfsaldanha/microdatasus}
}
}
