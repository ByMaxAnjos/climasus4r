% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/sus_data_filter_cid.R
\name{sus_data_filter_cid}
\alias{sus_data_filter_cid}
\title{Filter SUS health data by ICD-10 codes with multilingual support}
\usage{
sus_data_filter_cid(
  df,
  icd_codes,
  icd_column = NULL,
  match_type = "starts_with",
  lang = "en",
  verbose = TRUE
)
}
\arguments{
\item{df}{A \code{data.frame} or \code{tibble} containing SUS health data with ICD-10 codes.
Typically obtained from DATASUS systems (SIM, SIH, SINAN). The data should
contain at least one column with ICD-10 codes in standard format (e.g., "A00.0",
"I10", "C50.9").}

\item{icd_codes}{A character vector of ICD-10 codes, ranges, or categories.
Multiple syntaxes are supported:

\strong{Basic filtering:}
\itemize{
\item Single code: \code{"J18.9"} (Pneumonia, unspecified)
\item Multiple codes: \code{c("I10", "I11.0", "I11.9")} (Hypertensive diseases)
}

\strong{Range filtering:}
\itemize{
\item Complete range: \code{"J00-J99"} (All diseases of respiratory system)
\item Partial range: \code{"J09-J18"} (Influenza and pneumonia only)
}

\strong{Chapter filtering:}
\itemize{
\item Full chapter: \code{"I"} (All diseases of circulatory system, codes I00-I99)
\item Chapter group: \code{"C00-D48"} (All neoplasms)
}

\strong{Special SUS categories:}
\itemize{
\item \code{"causas_externas"} or \code{"external_causes"}: V01-Y98 (External causes)
\item \code{"causas_maternas"} or \code{"maternal_causes"}: O00-O99 (Pregnancy/childbirth)
\item \code{"causas_infantis"} or \code{"infant_causes"}: P00-P96 (Perinatal conditions)
\item \code{"doencas_infecciosas"} or \code{"infectious_diseases"}: A00-B99 (Infectious)
\item \code{"doencas_respiratorias"} or \code{"respiratory_diseases"}: J00-J99 (Respiratory)
\item \code{"doencas_cardiovasculares"} or \code{"cardiovascular_diseases"}: I00-I99 (Cardio)
\item \code{"neoplasias"} or \code{"neoplasms"}: C00-D48 (Neoplasms)
}

\strong{Brazilian epidemiological priorities:}
\itemize{
\item \code{"dengue_like"}: A90-A91 (Dengue) + A92.0-A92.9 (Other viral fevers)
\item \code{"zika_chik"}: A92.8 (Zika) + A92.0 (Chikungunya)
\item \code{"tb_respiratoria"}: A15-A16 (Respiratory tuberculosis)
\item \code{"covid19"}: U07.1 (COVID-19) + U07.2 (Suspected COVID-19)
\item \code{"violencia"}: X85-Y09 (Assault) + Y35-Y36 (Legal intervention)
}}

\item{icd_column}{Character. Name of the column containing ICD-10 codes.
If NULL (default), the function attempts auto-detection from common SUS
column names in this priority order:
\enumerate{
\item \code{"CAUSABAS"} - Underlying cause (primary cause of death in SIM)
\item \code{"DIAG_PRINC"} - Main diagnosis (SIH hospitalizations)
\item \code{"DIAG_SECUN"} - Secondary diagnosis
\item \code{"CAUSAOBITO"} - Cause of death (alternative SIM field)
\item \code{"DIAGNOSTIC"} - Diagnosis (SINAN notifiable diseases)
\item \code{"linha_a"} through \code{"linha_f"} - Multiple cause lines (SIM)
}}

\item{match_type}{Character. Type of matching algorithm:
\itemize{
\item \code{"exact"}: Exact code match (e.g., "I10" matches only "I10")
\item \code{"starts_with"}: Match codes starting with pattern (default, e.g., "I10" matches "I10", "I10.0", "I10.9")
\item \code{"range"}: Match codes within specified ranges (e.g., "I10-I15" matches I10-I15.9)
\item \code{"chapter"}: Match entire ICD-10 chapter (e.g., "I" matches I00-I99.9)
\item \code{"fuzzy"}: Allow for common SUS coding variations (e.g., "I10" matches "I10", "I10 ", "I10X")
}}

\item{lang}{Character. Language for user interface messages, warnings, and
documentation. Options:
\itemize{
\item \code{"en"}: English (default)
\item \code{"pt"}: Portuguese (recommended for Brazilian users)
\item \code{"es"}: Spanish
Affects all console output and documentation of matched codes.
}}

\item{verbose}{Logical. If TRUE (default), prints detailed filtering
information including: records processed, match statistics, common
coding issues detected, and time elapsed.}
}
\value{
A filtered \code{data.frame} or \code{tibble} containing only records matching
the specified ICD-10 criteria. The output preserves all original columns
}
\description{
Filters Brazilian Unified Health System (SUS) data based on ICD-10 codes
(International Classification of Diseases, 10th Revision). This function
supports complex filtering scenarios including specific codes, code ranges,
chapters, and disease groups relevant to epidemiological research in Brazil.
Includes specialized support for SUS-specific coding practices and
multilingual interface (English, Portuguese, Spanish).
}
\details{
\subsection{ICD-10 in the Brazilian SUS Context}{

The Brazilian Ministry of Health adopted ICD-10 in 1996 for mortality
statistics (SIM) and later for morbidity (SIH, SINAN). Key characteristics:
\enumerate{
\item \strong{Code Format}: Standard ICD-10 format (letter + 2 digits + optional decimal)
\item \strong{SUS Extensions}: Some codes have Brazilian extensions (e.g., U07.1 for COVID-19)
\item \strong{Multiple Causes}: SIM data includes up to 6 cause lines (linha_a to linha_f)
\item \strong{Common Issues}: Inconsistent formatting, extra spaces, deprecated codes
}
}

\subsection{Filtering Algorithm Details}{

\strong{Exact Matching}: Case-insensitive exact string match
\strong{Starts_with Matching}: Uses regex \verb{^CODE} for prefix matching
\strong{Range Matching}: Handles both simple (A00-A09) and complex ranges
\strong{Chapter Matching}: Maps single letters to full chapter ranges
\strong{Fuzzy Matching}: Accounts for common SUS data quality issues:
\itemize{
\item Trailing/leading spaces
\item Missing dots (A000 vs A00.0)
\item Extra characters (A00.0X)
\item Case variations
}
}

\subsection{Performance Considerations}{
\itemize{
\item For large datasets (>1M rows), consider preprocessing ICD column
\item Range matching is slower than exact/starts_with
\item Fuzzy matching has additional computational cost
\item Metadata columns add minimal overhead
}
}

\subsection{SUS-Specific Features}{
\enumerate{
\item \strong{Automatic mapping} of Brazilian Portuguese disease groups
\item \strong{Validation} against SUS-specific code lists
\item \strong{Support} for multiple cause of death lines
\item \strong{Detection} of common SUS data entry errors
\item \strong{Integration} with other \code{climasus4r} functions
}
}
}
\note{
Important considerations for SUS data:
\enumerate{
\item \strong{Code Updates}: ICD-10 is periodically updated; some older codes deprecated
\item \strong{Data Quality}: SIM has >90\% completeness, but coding errors occur
\item \strong{Multiple Causes}: Consider filtering multiple cause columns for completeness
\item \strong{Year Variations}: Coding practices changed over time in SUS
\item \strong{Training Required}: Proper ICD-10 use requires training for accurate results
}
}
\section{ICD-10 Chapters Relevant to Climate-Health Research}{

Common chapters for environmental health studies:
\itemize{
\item \strong{J00-J99}: Respiratory diseases (air pollution, climate)
\item \strong{A00-A09}: Intestinal infectious diseases (water quality, temperature)
\item \strong{A15-A19}: Tuberculosis (crowding, ventilation)
\item \strong{A90-A99}: Viral fevers (dengue, Zika, climate vectors)
\item \strong{I00-I99}: Circulatory diseases (heat waves, cold spells)
\item \strong{T66-T78}: Other external causes (temperature extremes)
\item \strong{X30-X39}: Exposure to forces of nature (climate events)
}
}

\examples{
\dontrun{
# Load example SIM dataset
# Contains CAUSABAS column with ICD-10 codes
sim_example <- sus_data_import(
  uf = "RJ", 
  year = 2022, 
  system = "SIM-DO",
  use_cache = TRUE
)
# Example 1: Filter for respiratory diseases (Portuguese interface)
df_respiratorio <- sus_data_filter_cid(
  df = sim_example,
  icd_codes = "J00-J99",
  lang = "pt",
  verbose = TRUE
)

# Example 2: Filter for climate-sensitive diseases
df_climate <- sus_data_filter_cid(
  df = sim_example,
  icd_codes = c(
    "J00-J99",      # Respiratory
    "A00-A09",      # Intestinal infectious
    "A90-A99",      # Arthropod-borne viral
    "I10-I15"       # Hypertensive diseases
  ),
  icd_column = "CAUSABAS",
  match_type = "range",
)

# Example 3: Use SUS-specific categories
df_maternal <- sus_data_filter_cid(
  df = sim_example,
  icd_codes = "causas_maternas",  # Maps to O00-O99
  lang = "pt"
)

# Example 4: Filter with fuzzy matching for data quality issues
df_dengue <- sus_data_filter_cid(
  df = sinan_example,
  icd_codes = c("A90", "A91"),
  match_type = "fuzzy",  # Handles coding variations
)

# Example 5: Multi-language comparison
df_english <- sus_data_filter_cid(df, "I10-I15", lang = "en")
df_portugues <- sus_data_filter_cid(df, "I10-I15", lang = "pt")
df_espanhol <- sus_data_filter_cid(df, "I10-I15", lang = "es")
}

}
\references{
\enumerate{
\item World Health Organization. (2016). ICD-10 International Statistical
Classification of Diseases and Related Health Problems. 10th Revision.
\item Brazilian Ministry of Health. (2023). Classificacao Estatistica
Internacional de Doencas e Problemas Relacionados a Saude - CID-10.
DATASUS. \url{http://datasus.saude.gov.br/cid10}
}
}
