<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Aggregate Health Data into Time Series — sus_data_aggregate • climasus4r</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/Inter-0.4.10/font.css" rel="stylesheet"><link href="../deps/Fira_Code-0.4.10/font.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Aggregate Health Data into Time Series — sus_data_aggregate"><meta name="description" content="Aggregates individual-level health data into time series counts by specified
time units and grouping variables. This function is essential for preparing
data for time series analysis, DLNM models, and other temporal epidemiological methods."><meta property="og:description" content="Aggregates individual-level health data into time series counts by specified
time units and grouping variables. This function is essential for preparing
data for time series analysis, DLNM models, and other temporal epidemiological methods."><link rel="stylesheet" href="pkgdown/assets/custom-modern.css"><link rel="icon" type="image/png" href="pkgdown/assets/favicon.png"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">climasus4r</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.0.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../index.html">Home</a></li>
<li class="nav-item"><a class="nav-link" href="../articles/about.html">About</a></li>
<li class="nav-item"><a class="nav-link" href="../articles/tutorials.html">Tutorials</a></li>
<li class="nav-item"><a class="nav-link" href="../articles/case-studies.html">Case Studies</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-community" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Community</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-community"><li><a class="external-link dropdown-item" href="https://github.com/ByMaxAnjos/climasus4r/issues">GitHub Issues</a></li>
    <li><a class="external-link dropdown-item" href="https://github.com/ByMaxAnjos/climasus4r/discussions">Discussions</a></li>
  </ul></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">News</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><a class="external-link nav-link" href="https://climasus4r.manus.space/" target="_blank"><span class="fa fa-robot"></span> AI Assistant</a></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/ByMaxAnjos/climasus4r"><span class="fa fa-github"></span></a></li>
<li class="nav-item"><a class="nav-link" href="../../pt/index.html">Português</a></li>
<li class="nav-item"><a class="nav-link" href="../../es/index.html">Español</a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Aggregate Health Data into Time Series</h1>
      <small class="dont-index">Source: <a href="https://github.com/ByMaxAnjos/climasus4r/blob/master/R/sus_data_aggregate.R" class="external-link"><code>R/sus_data_aggregate.R</code></a></small>
      <div class="d-none name"><code>sus_data_aggregate.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Aggregates individual-level health data into time series counts by specified
time units and grouping variables. This function is essential for preparing
data for time series analysis, DLNM models, and other temporal epidemiological methods.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">sus_data_aggregate</span><span class="op">(</span></span>
<span>  <span class="va">df</span>,</span>
<span>  time_unit <span class="op">=</span> <span class="st">"day"</span>,</span>
<span>  fun <span class="op">=</span> <span class="st">"count"</span>,</span>
<span>  value_col <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  group_by <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  complete_dates <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  date_col <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  lang <span class="op">=</span> <span class="st">"pt"</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-df">df<a class="anchor" aria-label="anchor" href="#arg-df"></a></dt>
<dd><p>A data frame containing health data (output from <code><a href="sus_data_standardize.html">sus_data_standardize()</a></code>, or <code>sus_data_filter*()</code>).</p></dd>


<dt id="arg-time-unit">time_unit<a class="anchor" aria-label="anchor" href="#arg-time-unit"></a></dt>
<dd><p>Character string specifying the temporal aggregation unit.
<strong>Standard units</strong>: <code>"day"</code>, <code>"week"</code>, <code>"month"</code>, <code>"quarter"</code>, <code>"year"</code>
<strong>Multi-day/week/month</strong>: <code>"2 days"</code>, <code>"5 days"</code> (pentads), <code>"14 days"</code> (fortnightly),
<code>"3 months"</code> (trimester), <code>"6 months"</code> (semester).
<strong>Special</strong>: <code>"season"</code> (Brazilian seasons: DJF, MAM, JJA, SON).
Default is <code>"day"</code>.</p></dd>


<dt id="arg-fun">fun<a class="anchor" aria-label="anchor" href="#arg-fun"></a></dt>
<dd><p>Character string or list of functions specifying the aggregation function(s).
Options: <code>"count"</code> (default), <code>"sum"</code>, <code>"mean"</code>, <code>"median"</code>, <code>"min"</code>, <code>"max"</code>,
<code>"sd"</code>, <code>"q25"</code> (25th percentile), <code>"q75"</code>, <code>"q95"</code>, and <code>"q99"</code>.
Can also be a named list for multiple aggregations, e.g.,
<code>list(mean_temp = "mean", max_temp = "max")</code>.</p></dd>


<dt id="arg-value-col">value_col<a class="anchor" aria-label="anchor" href="#arg-value-col"></a></dt>
<dd><p>Character string with the name of the column to aggregate when
using functions other than <code>"count"</code>. Required for <code>"sum"</code>, <code>"mean"</code>, etc.
For example, <code>"temperature"</code>, <code>"precipitation"</code>, <code>"pm25"</code>.</p></dd>


<dt id="arg-group-by">group_by<a class="anchor" aria-label="anchor" href="#arg-group-by"></a></dt>
<dd><p>Character vector with names of columns to group by (e.g.,
<code>c("sex", "age_group", "municipality_code", "race")</code>). If <code>NULL</code> (default), aggregates
across all records.</p></dd>


<dt id="arg-complete-dates">complete_dates<a class="anchor" aria-label="anchor" href="#arg-complete-dates"></a></dt>
<dd><p>Logical. If <code>TRUE</code> (default), fills in missing time periods
with zero counts to create a complete time series without gaps.</p></dd>


<dt id="arg-date-col">date_col<a class="anchor" aria-label="anchor" href="#arg-date-col"></a></dt>
<dd><p>Character string with the name of the date column to use for
aggregation. If <code>NULL</code> (default), the function will attempt to auto-detect
the date column based on common patterns.</p></dd>


<dt id="arg-lang">lang<a class="anchor" aria-label="anchor" href="#arg-lang"></a></dt>
<dd><p>Character string specifying the language for messages. Options:
<code>"en"</code> (English, default), <code>"pt"</code> (Portuguese, default), <code>"es"</code> (Spanish).</p></dd>


<dt id="arg-verbose">verbose<a class="anchor" aria-label="anchor" href="#arg-verbose"></a></dt>
<dd><p>Logical. If <code>TRUE</code> (default), prints progress messages.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A tibble with aggregated data containing:</p><ul><li><p><code>date</code>: The aggregated date (start of period)</p></li>
<li><p>Grouping columns (if <code>group_by</code> was specified)</p></li>
<li><p>Aggregated value column(s) with smart names based on system and function</p></li>
</ul></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p><strong>New Features</strong>:</p><ul><li><p><strong>Multiple aggregation functions</strong>: Beyond counting, you can now calculate
mean, sum, median, percentiles, etc., useful for climate and environmental data.</p></li>
<li><p><strong>Smart column naming</strong>: The aggregated column is automatically named
based on the health system (e.g., <code>n_deaths</code> for SIM-DO, <code>n_hospitalizations</code>
for SIH-RD, <code>n_births</code> for SINASC).</p></li>
</ul><p><strong>Epidemiological Use Cases</strong>:</p><ul><li><p><strong>Daily/Weekly</strong>: Standard time series analysis, DLNM for short-term effects</p></li>
<li><p><strong>Pentads (5 days)</strong>: Heat wave analysis, smoothing daily noise</p></li>
<li><p><strong>Fortnightly (14 days)</strong>: Diseases with longer incubation periods</p></li>
<li><p><strong>Monthly</strong>: Seasonal patterns, long-term trends</p></li>
<li><p><strong>Quarterly</strong>: SUS management reports, policy evaluation</p></li>
<li><p><strong>Seasonal</strong>: Dengue, Influenza, respiratory diseases aligned with Brazilian climate</p></li>
<li><p><strong>Yearly</strong>: Long-term trend analysis, climate change impacts</p></li>
</ul><p><strong>Brazilian Seasons</strong> (when <code>time_unit = "season"</code>):</p><ul><li><p><strong>Summer (Verao)</strong>: December-January-February (DJF)</p></li>
<li><p><strong>Autumn (Outono)</strong>: March-April-May (MAM)</p></li>
<li><p><strong>Winter (Inverno)</strong>: June-July-August (JJA)</p></li>
<li><p><strong>Spring (Primavera)</strong>: September-October-November (SON)</p></li>
</ul></div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span> <span class="co"># \dontrun{</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">climasus4r</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Basic daily aggregation</span></span>
<span><span class="va">df_daily</span> <span class="op">&lt;-</span> <span class="fu"><a href="sus_data_import.html">sus_data_import</a></span><span class="op">(</span>uf <span class="op">=</span> <span class="st">"SP"</span>, year <span class="op">=</span> <span class="fl">2023</span>, system <span class="op">=</span> <span class="st">"SIM-DO"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="sus_data_standardize.html">sus_data_standardize</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="sus_data_filter_cid.html">sus_data_filter_cid</a></span><span class="op">(</span>disease_group <span class="op">=</span> <span class="st">"respiratory"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">sus_data_aggregate</span><span class="op">(</span>time_unit <span class="op">=</span> <span class="st">"day"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Pentad aggregation (5-day periods) for heat wave analysis</span></span>
<span><span class="va">df_pentad</span> <span class="op">&lt;-</span> <span class="fu">sus_data_aggregate</span><span class="op">(</span><span class="va">df</span>, time_unit <span class="op">=</span> <span class="st">"5 days"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Fortnightly aggregation for diseases with longer incubation</span></span>
<span><span class="va">df_fortnightly</span> <span class="op">&lt;-</span> <span class="fu">sus_data_aggregate</span><span class="op">(</span><span class="va">df</span>, time_unit <span class="op">=</span> <span class="st">"14 days"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Monthly aggregation by municipality</span></span>
<span><span class="va">df_monthly</span> <span class="op">&lt;-</span> <span class="fu">sus_data_aggregate</span><span class="op">(</span></span>
<span>  <span class="va">df</span>,</span>
<span>  time_unit <span class="op">=</span> <span class="st">"month"</span>,</span>
<span>  group_by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"race"</span>, <span class="st">"sex"</span><span class="op">)</span>,</span>
<span>  lang <span class="op">=</span> <span class="st">"pt"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Quarterly aggregation for SUS reports</span></span>
<span><span class="va">df_quarterly</span> <span class="op">&lt;-</span> <span class="fu">sus_data_aggregate</span><span class="op">(</span><span class="va">df</span>, time_unit <span class="op">=</span> <span class="st">"quarter"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Seasonal aggregation for dengue analysis (Brazilian seasons)</span></span>
<span><span class="va">df_seasonal</span> <span class="op">&lt;-</span> <span class="fu">sus_data_aggregate</span><span class="op">(</span></span>
<span>  <span class="va">df</span>,</span>
<span>  time_unit <span class="op">=</span> <span class="st">"season"</span>,</span>
<span>  group_by <span class="op">=</span> <span class="st">"state"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Weekly aggregation by age group and sex</span></span>
<span><span class="va">df_weekly</span> <span class="op">&lt;-</span> <span class="fu">sus_data_aggregate</span><span class="op">(</span></span>
<span>  <span class="va">df</span>,</span>
<span>  time_unit <span class="op">=</span> <span class="st">"week"</span>,</span>
<span>  group_by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"age_group"</span>, <span class="st">"sex"</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="op">}</span> <span class="co"># }</span></span></code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Max Anjos, Thaua Menezes.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer></div>





  </body></html>

